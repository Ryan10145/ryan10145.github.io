<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Roots of Unity Filter Part 3 - Roots of Unity Filter" /><meta property="og:locale" content="en_US" /><meta name="description" content="Note" /><meta property="og:description" content="Note" /><link rel="canonical" href="https://ryan10145.github.io/posts/roots-of-unity-filter/" /><meta property="og:url" content="https://ryan10145.github.io/posts/roots-of-unity-filter/" /><meta property="og:site_name" content="Ryan Chang" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-04-18T15:15:00-04:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Roots of Unity Filter Part 3 - Roots of Unity Filter" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"datePublished":"2021-04-18T15:15:00-04:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://ryan10145.github.io/posts/roots-of-unity-filter/"},"description":"Note","url":"https://ryan10145.github.io/posts/roots-of-unity-filter/","@type":"BlogPosting","headline":"Roots of Unity Filter Part 3 - Roots of Unity Filter","dateModified":"2021-05-04T23:06:30-04:00","@context":"https://schema.org"}</script><title>Roots of Unity Filter Part 3 - Roots of Unity Filter | Ryan Chang</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://avatars.githubusercontent.com/u/8119928?v=4" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Ryan Chang</a></div><div class="site-subtitle font-italic">High school senior going to MIT this fall to study computer science</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT ME</span> </a><li class="nav-item"> <a href="/projects/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>PROJECTS</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/ryan10145" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['chang.ryan10145','gmail.com'].join('@')" aria-label="email" class="order-4" > <i class="fas fa-envelope"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG â€º <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Roots of Unity Filter Part 3 - Roots of Unity Filter</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Roots of Unity Filter Part 3 - Roots of Unity Filter</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Ryan Chang </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sun, Apr 18, 2021, 3:15 PM -0400" prep="on" > Apr 18 <i class="unloaded">2021-04-18T15:15:00-04:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Tue, May 4, 2021, 11:06 PM -0400" prefix="Updated " > May 4 <i class="unloaded">2021-05-04T23:06:30-04:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2777 words">15 min</span></div></div><div class="post-content"><h2 id="note">Note</h2><p>This is a three part series I wrote back in 2019 on a technique applicable to certain competitive math problems: roots of unity filters. See the first two parts for a recap of complex numbers and roots of unity respectively. This post will actually go over the technique as well as what kind of problems it can be applied to.</p><blockquote class="blockquote-warning"><hr /> Many of the explanations for this section will not be rigorous proofs.</blockquote><h2 id="guiding-problem">Guiding Problem</h2><p>The main problem we are trying to tackle in this section is the following from one of Thomas Mildorfâ€™s mock AIMEs:</p><blockquote class="blockquote-example"><hr /> <i>Problem from Thomas Mildorf's Mock AIME 1: #11</i> <br /> Let $S$ denote the value of the sum $$\sum_{n = 0}^{668}(-1)^n{2004 \choose 3n}$$ Determine $S$</blockquote><p>We can tackle this problem in a variety of ways, but the approach we will be using here is a technique known as <strong>roots of unity filter</strong>.</p><h2 id="description">Description</h2><p>Roots of unity filter is a technique that allows us to find the sum of every $k$th coefficient in a polynomial with any given offset less than $k$. For instance, if you had a polynomial with a degree of $20$, you could find the sum of the 2nd, 5th, 8th, â€¦, and 20th coefficients. This would correspond to every 3rd coefficient with an offset of $2$.</p><p>While on its own the roots of unity filter doesnâ€™t have a lot of applications, it is especially powerful when applied to the binomial theorem. For instance, with the guiding problem, we can expand the summation to find the following;</p>\[{2004 \choose 0} - {2004 \choose 3} + {2004 \choose 6} - {2004 \choose 9} + ... + {2004 \choose 2004} =\] \[{2004 \choose 0} + {2004 \choose 6} + ... + {2004 \choose 2004} - \left({2004 \choose 3} + {2004 \choose 9} + ... + {2004 \choose 2001}\right)\]<p>We can see that this problem is asking us to calculate the sum of every 6th binomial coefficient with an offset of $0$ and then subtract the sum of every 6th binomial coefficient with an offset of $3$.</p><p>We can apply the roots of unity filter if we had a polynomial that had binomial coefficients as its coefficients. We can obtain this with the following polynomial:</p>\[(x + 1)^n = {n \choose 0} + {n \choose 1} + {n \choose 2} + ... + {n \choose n}\]<p>To solve our problem from above, we can utilize the root of unity filter on this polynomial with $n = 2004$ to determine the sum of every 6th coefficient with offset $0$ and the sum of every 6th coefficient with offset $3$. Then, we can subtract the latter from the former and obtain the answer.</p><h2 id="no-offset-version">No Offset Version</h2><p>The simplest method to apply roots of unity filter is when youâ€™re dealing with an offset of $0$ since you donâ€™t have to do much work. If you want to find the sum of every $n$th coefficient with an offset of $0$ for a polynomial $P(x)$, you can calculate it with the following expression, where $\omega$ represents the smallest $nth$ root of unity:</p>\[\dfrac{P(1) + P(\omega) + P(\omega^2) + ... + P(\omega^{n - 1})}{n}\]<p>Essentially, we just have to plug in the $n$th roots of unity, where $n$ is the desired cycle length, and then take the average of the results.</p><h3 id="explanation">Explanation</h3><p>To see why this works, we can utilize the following two facts that we proved previously about roots of unity:</p>\[\omega^{n + i} = \omega^i\] \[1 + \omega + \omega^2 + ... + \omega^{n - 1} = 0\]<p>Armed with this information, we can examine what happens when we plug the roots of unity into the polynomial $P(x)$. For this section, weâ€™re going to use a polynomial $P(x)$ with a degree of $10$ and calculate the sum of every third term. However, this can be generalized to any degree polynomial for any cycle length. First of all, letâ€™s write a polynomial $P(x)$ with a degree of $10$ as the following:</p>\[P(x) = a_0 + a_1x + a_2x^2 + a_3x^3 + ... + a_{10}x^{10}\]<p>When we plug in $\omega$ as our root of unity, we obtain the following:</p>\[P(\omega) = a_0 + a_1\omega + a_2\omega^2 + a_3\omega^3 + ... + a_{10}\omega^{10}\]<p>However, note that when the power of $\omega$ exceeds $3$, we can factor out $\omega^3 = 1$. This means that after the term $\omega^2$, the powers of $\omega$ will repeat in a cycle of length $3$. We can show this result with the other powers of $\omega$ we are plugging in as well. Whenever we pass $\omega^{3i}$ in our polynomial after passing in $\omega^i$ to the polynomial, we can factor out that $\omega^{3i} = 1$.</p><p>Since the terms of all of the polynomials are cyclic when plugging in the roots of unities, if we can show that summing all of the polynomials makes it so that only the coefficient of $a_0$ remain, it will necessarily apply to $a_3, a_6, â€¦$ as well. Therefore, we can direct our focus to what happens with the first $3$ terms of the polynomial when we pass in $1, \omega$, and $\omega^2$.</p><p>We can make the following chart to look at what happens:</p><div class="table-wrapper"><table><thead><tr><th>Root of Unity<th>$a_0$<th>$a_1$<th>$a_2$<th>Â <tbody><tr><td>$1$<td>$1$<td>$1$<td>$1$<td>Â <tr><td>$\omega$<td>$1$<td>$\omega$<td>$\omega^2$<td>Â <tr><td>$\omega^2$<td>$1$<td>$\omega^2$<td>$\omega^4$<td>Â <tr><td><strong>Total Sum</strong><td><strong>$3$</strong><td><strong>$0$</strong><td><strong>$0$</strong><td>Â </table></div><p>The columns each correspond to what power we are raising each of the roots of unity, while the rows indicate each of the roots of unity. If we sum all of the columns, we will obtain how much of each coefficient we shall receive in the final sum.</p><p>Note that from the equation \(1 + \omega + \omega^2 + ... + \omega^{n - 1} = 0\) all of the columns except for the one corresponding to $a_0$ end up with a sum of $0$. In the third column, the equation is applied with just $\omega$ plugged in, and in the fourth column, the equation is applied with $\omega^2$ plugged in. Therefore, our result is just $a_0$ added $3$ times, so we can divide by $3$ to obtain our desired sum.</p><p>Again, remember that since the roots of unity are cyclic with a period of $3$, the same values and chart will apply for $a_3$ through $a_5$, $a_6$ through $a_8$, etc. To see this, looking at the entire chart is useful, which is placed below for your convenience.</p><div class="table-wrapper"><table><thead><tr><th>Â <th style="text-align: right">$a_0$<th style="text-align: right">$a_1$<th style="text-align: right">$a_2$<th style="text-align: right">$a_3$<th style="text-align: right">$a_4$<th style="text-align: right">$a_5$<th style="text-align: right">$a_6$<th style="text-align: right">$a_7$<th style="text-align: right">$a_8$<th style="text-align: right">$a_9$<th style="text-align: right">$a_{10}$<th>Â <tbody><tr><td>$1$<td style="text-align: right">$1$<td style="text-align: right">$1$<td style="text-align: right">$1$<td style="text-align: right">$1$<td style="text-align: right">$1$<td style="text-align: right">$1$<td style="text-align: right">$1$<td style="text-align: right">$1$<td style="text-align: right">$1$<td style="text-align: right">$1$<td style="text-align: right">$1$<td>Â <tr><td>$\omega$<td style="text-align: right">$1$<td style="text-align: right">$\omega$<td style="text-align: right">$\omega^2$<td style="text-align: right">$\omega^3 = 1$<td style="text-align: right">$\omega^4 = \omega$<td style="text-align: right">$\omega^5 = \omega^2$<td style="text-align: right">$\omega^6 = 1$<td style="text-align: right">$\omega^7 = \omega$<td style="text-align: right">$\omega^8 = \omega^2$<td style="text-align: right">$\omega^6 = 1$<td style="text-align: right">$\omega^7 = \omega$<td>Â <tr><td>$\omega^2$<td style="text-align: right">$1$<td style="text-align: right">$\omega^2$<td style="text-align: right">$\omega^4$<td style="text-align: right">$\omega^6 = 1$<td style="text-align: right">$\omega^8 = \omega^2$<td style="text-align: right">$\omega^{10} = \omega^4$<td style="text-align: right">$\omega^{12} = 1$<td style="text-align: right">$\omega^{14} = \omega^2$<td style="text-align: right">$\omega^{16} = \omega^4$<td style="text-align: right">$\omega^{18} = 1$<td style="text-align: right">$\omega^{20} = \omega^{20}$<td>Â <tr><td><strong>Total Sum</strong><td style="text-align: right"><strong>$3$</strong><td style="text-align: right"><strong>$0$</strong><td style="text-align: right"><strong>$0$</strong><td style="text-align: right"><strong>$3$</strong><td style="text-align: right"><strong>$0$</strong><td style="text-align: right"><strong>$0$</strong><td style="text-align: right"><strong>$3$</strong><td style="text-align: right"><strong>$0$</strong><td style="text-align: right"><strong>$0$</strong><td style="text-align: right"><strong>$3$</strong><td style="text-align: right"><strong>$0$</strong><td>Â </table></div><blockquote class="blockquote-example"><hr /> Find $S = {10 \choose 0} + {10 \choose 4} + {10 \choose 8}$ without calculating any binary coefficients</blockquote><p>We can approach this problem by first realizing that we need to find the sum of every 4th coefficient in the polynomial:</p>\[(x + 1)^{10}\]<p>By applying the roots of unity filter, we can realize that this is equivalent to the following:</p>\[\omega = \text{cis}\left( \dfrac{2\pi}{4} \right)\] \[\dfrac{(1 + 1)^{10} + (\omega + 1)^{10} + (\omega^2 + 1)^{10} + (\omega^4 + 1)^{10}}{4}\] \[\dfrac{(2)^{10} + (1 + i)^{10} + (0)^{10} + (1 - i)^{10}}{4}\]<p>We can then find this sum by converting each of the complex numbers to polar form, applying de Moivreâ€™s theorem, and then converting back to rectangular coordinates. While this may seem lengthy for a problem we could have just calculated the binomial coefficients for, it is a general technique that has the same number of terms even as the upper number increases to huge numbers.</p><p>We continue the calculation below for the sake of completeness:</p>\[(1 + i)^{10} = \left(\sqrt{2}\text{cis}\left(\dfrac{\pi}{4}\right)\right)^{10} = 2^5\text{cis}\left(\dfrac{10\pi}{4}\right) = 2^5(0 + i) = 2^5i\] \[(1 - i)^{10} = \left(\sqrt{2}\text{cis}\left(\dfrac{-\pi}{4}\right)\right)^{10} = 2^5\text{cis}\left(\dfrac{-10\pi}{4}\right) = 2^5(0 - i) = -2^5i\] \[S = \dfrac{2^{10} + 2^5i + 0 - 2^5i}{4} = \boxed{2^8 = 256}\]<p>To check our answer, we can compute the binomial coefficients manually and get $1 + 210 + 45 = 256$.</p><blockquote class="blockquote-note"><hr /> A frequent math competition technique is to plug $1$ and $-1$ into a polynomial $P(x)$, add them together, and then divide by $2$ to cancel out all of the odd degree terms. This is actually the roots of unity filter being used with $n = 2$ since $1$ and $-1$ are the second roots of unity!</blockquote><h2 id="with-offset-version">With Offset Version</h2><p>While the previous version of roots of unity filter is already pretty powerful and can solve a lot of math problems, the more general version to find sums with offsets. Note that we still cannot solve our guiding problem because, in that problem, we have to be able to calculate the sum of the coefficients with a period pf $6$, but with an offset of $3$.</p><p>To get an idea of how this will work, we can once again look at the chart we created earlier that matches up what happens when we plug in each of the roots of unity for the terms in our polynomial.</p><div class="table-wrapper"><table><thead><tr><th>Root of Unity<th>$a_0$<th>$a_1$<th>$a_2$<th>Â <tbody><tr><td>$1$<td>$1$<td>$1$<td>$1$<td>Â <tr><td>$\omega$<td>$1$<td>$\omega$<td>$\omega^2$<td>Â <tr><td>$\omega^2$<td>$1$<td>$\omega^2$<td>$\omega^4$<td>Â <tr><td><strong>Total Sum</strong><td><strong>$3$</strong><td><strong>$0$</strong><td><strong>$0$</strong><td>Â </table></div><p>Note that the main reason this worked out was that we had $1$ appear in every row for the term we wanted: $a_0$. That way, when we summed up the polynomial evaluated at each of the roots of unity, everything else would cancel out via the crucial identity \(1 + \omega + \omega^2 + ... + \omega^{n - 1} = 0\) but the $1$s would not.</p><p>This time, say that the desired coefficient is $a_1$, meaning that we want an offset of $1$ instead of $0$. To do this, the key is to add some coefficient in front of each term in our sum to ensure that our sum has $1$s in the column for our desired term: $a_1$. Then, if we called those coefficients $b_i$, the sum of every 3rd term with an offset of 1 would look like this: \(\dfrac{b_0P(1) + b_1P(\omega) + b_2(\omega^2)}{3}\)</p><p>To calculate these coefficients, we can use our table from above. Currently, it would look something like this, where all of our coefficients would be $1$, meaning that the values for each row are not being changed.</p><div class="table-wrapper"><table><thead><tr><th>Root of Unity<th>$b_i$<th>$a_0$<th>$a_1$<th>$a_2$<th>Â <tbody><tr><td>$1$<td>$1$<td>$1$<td>$1$<td>$1$<td>Â <tr><td>$\omega$<td>$1$<td>$1$<td>$\omega$<td>$\omega^2$<td>Â <tr><td>$\omega^2$<td>$1$<td>$1$<td>$\omega^2$<td>$\omega^4$<td>Â <tr><td><strong>Total Sum</strong><td>Â <td><strong>$3$</strong><td><strong>$0$</strong><td><strong>$0$</strong><td>Â </table></div><p>However, by using the crucial property that $\omega^n = 1$, we can adjust the coefficients for each row so that the $1$s appear in the column for $a_1$ instead:</p><div class="table-wrapper"><table><thead><tr><th>Root of Unity<th>$b_i$<th>$a_0$<th>$a_1$<th>$a_2$<th>Â <tbody><tr><td>$1$<td>$1$<td>$1$<td>$1$<td>$1$<td>Â <tr><td>$\omega$<td>$\omega^2$<td>$\omega^2$<td>$1$<td>$\omega^4$<td>Â <tr><td>$\omega^2$<td>$\omega$<td>$\omega$<td>$1$<td>$\omega^2$<td>Â <tr><td><strong>Total Sum</strong><td>Â <td><strong>$0$</strong><td><strong>$3$</strong><td><strong>$0$</strong><td>Â </table></div><p>With these coefficients chosen carefully, each sum now conveniently produces the values for $a_1$!</p><blockquote class="blockquote-note"><hr /> I currently don't have a good explanation for why all of the other columns conveniently end up still canceling each other out no matter which column you choose to make the $1$s generate in. To show that they do cancel out to $0$ (they don't nicely use the equation shown before anymore), you have to do a bit of work, but it should work out. If anyone has any ideas, feel free to leave a comment on this post.</blockquote><p>With this, our equation to find the sum of every 3rd term with an offset of $1$ looks like the following:</p>\[\dfrac{P(1) + \omega^2 P(\omega) + \omega P(\omega^2)}{3}\]<h2 id="solving-the-guiding-problem">Solving the Guiding Problem</h2><p>Armed with this knowledge, we can know solve our guiding problem. If you need a refresher, the problem boils down to the following:</p>\[{2004 \choose 0} + {2004 \choose 6} + ... + {2004 \choose 2004} - \left({2004 \choose 3} + {2004 \choose 9} + ... + {2004 \choose 2001}\right)\]<p>To do this, we need to find the sum of every 6th coefficient with an offset of 0 and the sum of every 6th coefficient with an offset of 3 for the polynomial</p>\[P(x) = (x + 1)^{2004}\]<p>We will call the first sum $S_1$ and the second sum $S_2$. We can apply the no offset roots of unity filter to calculate $S_1$:</p>\[\omega = \text{cis}\left(\dfrac{2\pi}{6}\right) = \text{cis}\left(\dfrac{\pi}{3}\right)\] \[S_1 = \dfrac{P(1) + P(\omega) + P(\omega^2) + P(\omega^3) + P(\omega^4) + P(\omega^5)}{6}\]<p>While we could plug this in and solve for $S_1$ directly, it would be incredibly difficult. However, we can proceed with calculating $S_2$ to see if we get any nice cancellations. We can apply our offsetted roots of unity filter to calculate $S_2$. To do so, we first need to find what our coefficients will be to get our column of $1$s to shift to $a_3$, which will give us the offset of $3$ that we need.</p><div class="table-wrapper"><table><thead><tr><th>Root of Unity<th>$b_i$<th>Original $a_3$<th>Modified $a_3$<tbody><tr><td>$1$<td>$1$<td>$1$<td>$1$<tr><td>$\omega$<td>$\omega^3$<td>$\omega^3$<td>$1$<tr><td>$\omega^2$<td>$1$<td>$\omega^6$<td>$1$<tr><td>$\omega^3$<td>$\omega^3$<td>$\omega^9$<td>$1$<tr><td>$\omega^4$<td>$1$<td>$\omega^{12}$<td>$1$<tr><td>$\omega^5$<td>$\omega^3$<td>$\omega^{15}$<td>$1$</table></div><p>Note that the way we choose the coefficients $b_i$ is that we want the coefficient of $\omega$ to increase so it becomes a multiple of $n = 6$ and the coefficient evaluates to $1$.</p><p>Then, we can calculate $S_2$ as:</p>\[\omega^3 = \text{cis}(\pi) = -1\] \[S_2 = \dfrac{P(1) - P(\omega) + P(\omega^2) - P(\omega^3) + P(\omega^4) - P(\omega^5)}{6}\]<p>When we combine this with to get our total answer of $S_1 - S_2$, we obtain the following:</p>\[S_1 - S_2 = \dfrac{\cancel{P(1)} + P(\omega) + \cancel{P(\omega^2)} + P(\omega^3) + \cancel{P(\omega^4)} + P(\omega^5) - \cancel{P(1)} + P(\omega) - \cancel{P(\omega^2)} + P(\omega^3) - \cancel{P(\omega^4)} + P(\omega^5)}{6}\] \[S_1 - S_2 = \dfrac{P(\omega) + P(\omega^3) + P(\omega^5)}{3}\]<p>Now that our sum is greatly simplified, we can plug in $P(x) = (x + 1)^{2004}$ and see what we can cancel out. The first thing we can notice is that $\omega^3 = -1$ as derived above, so our middle term cancels out to $(1 - 1)^{2004} = 0$, so we can ignore that. The next thing we can do is calculate what $\omega$ is in rectangular form so that we can add the $1$ to it as part of $P(x)$.</p>\[\omega = \text{cis}\left(\dfrac{\pi}{3}\right) = \cos\left(\dfrac{\pi}{3}\right) + i\sin\left(\dfrac{\pi}{3}\right) = \dfrac{1}{2} + \dfrac{\sqrt{3}}{2}i\] \[P(\omega) = \left(1 + \dfrac{1}{2} + \dfrac{\sqrt{3}}{2}i\right)^{2004} = \left(\dfrac{3}{2} + \dfrac{\sqrt{3}}{2}i\right)^{2004}\]<p>To calculate this, we can use de Moivreâ€™s theorem after converting $\dfrac{3}{2} + \dfrac{\sqrt{3}}{2}i$ to polar form.</p>\[\left|\dfrac{3}{2} + \dfrac{\sqrt{3}}{2}i\right| = \sqrt{\left(\dfrac{3}{2}\right)^2 + \left(\dfrac{\sqrt{3}}{2}\right)^2} = \sqrt{3}\] \[\text{arg}\left(\dfrac{3}{2} + \dfrac{\sqrt{3}}{2}i\right) = \text{atan}\left(\dfrac{\sqrt{3}}{3}\right) = \dfrac{\pi}{6}\] \[P(\omega) = \left(\dfrac{3}{2} + \dfrac{\sqrt{3}}{2}i\right)^{2004} = \left(\sqrt{3}\text{cis}\left(\dfrac{\pi}{6}\right)\right)^{2004} = 3^{1002}\text{cis}(334\pi) = 3^{1002}\]<p>We can do this with $\omega^5$ as well.</p>\[\omega^5 = \text{cis}\left(\dfrac{5\pi}{3}\right) = \cos\left(\dfrac{5\pi}{3}\right) + i\sin\left(\dfrac{5\pi}{3}\right) = \dfrac{1}{2} - \dfrac{\sqrt{3}}{2}i\] \[P(\omega^5) = \left(1 + \dfrac{1}{2} - \dfrac{\sqrt{3}}{2}i\right)^{2004} = \left(\dfrac{3}{2} - \dfrac{\sqrt{3}}{2}i\right)^{2004}\] \[\left|\dfrac{3}{2} - \dfrac{\sqrt{3}}{2}i\right| = \sqrt{\left(\dfrac{3}{2}\right)^2 + \left(\dfrac{\sqrt{3}}{2}\right)^2} = \sqrt{3}\] \[\text{arg}\left(\dfrac{3}{2} - \dfrac{\sqrt{3}}{2}i\right) = \text{atan}\left(\dfrac{\sqrt{3}}{-3}\right) = \dfrac{-\pi}{6}\] \[P(\omega^5) = \left(\dfrac{3}{2} - \dfrac{\sqrt{3}}{2}i\right)^{2004} = \left(\sqrt{3}\text{cis}\left(\dfrac{-\pi}{6}\right)\right)^{2004} = 3^{1002}\text{cis}(-334\pi) = 3^{1002}\]<p>Therefore, our final sum evaluates to:</p>\[S_1 - S_2 = \dfrac{P(\omega) + P(\omega^3) + P(\omega^5)}{3} = \dfrac{3^{1002} + 0 + 3^{1002}}{3} = \boxed{2 * 3^{1001}}\]<blockquote class="blockquote-note"><hr /> The original problem was part of a mock AIME and asked for the answer mod $1000$. Since this post is about roots of unity filter, we won't cover that part in depth, but to calculate the value mod $1000$, you could apply the Euler's Totient Theorem with $\phi(1000) = 40$ to find that $3^{1001} \equiv 3 \text{ } (\text{mod } 1000)$. Then, the answer is $(2 * 3) \text{ mod 1000} = \boxed{006}$.</blockquote><h2 id="final-notes">Final Notes</h2><p>Roots of unity filter is a super useful technique on some problems, but it can involve a lot of calculations and is not applicable to everything. For our guiding problem, we were fortunate enough to have all of our complex roots of unities dissipate nicely, which is something that you will frequently see for math competition problems that use roots of unity filter. Roots of unity filter can also be especially powerful when combined with <strong>generating functions</strong>. I might write an article on generating functions later, so stay tuned for that!</p><p>Generally, most problems will use the 4th roots of unity, which makes it incredibly convenient since all of the roots of unities are either entirely imaginary or entirely real. For less convenient problems, a calculator or some other clever insight may be necessary to evaluate the result.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/math-articles/'>Math Articles</a>, <a href='/categories/roots-of-unity-filter/'>Roots of Unity Filter</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/math/" class="post-tag no-text-decoration" >math</a> <a href="/tags/article/" class="post-tag no-text-decoration" >article</a> <a href="/tags/roots-of-unity-filter/" class="post-tag no-text-decoration" >roots of unity filter</a> <a href="/tags/roots-of-unity/" class="post-tag no-text-decoration" >roots of unity</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Roots of Unity Filter Part 3 - Roots of Unity Filter - Ryan Chang&url=https://ryan10145.github.io/posts/roots-of-unity-filter/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Roots of Unity Filter Part 3 - Roots of Unity Filter - Ryan Chang&u=https://ryan10145.github.io/posts/roots-of-unity-filter/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Roots of Unity Filter Part 3 - Roots of Unity Filter - Ryan Chang&url=https://ryan10145.github.io/posts/roots-of-unity-filter/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div>--- ---<div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Updates</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/roots-of-unity-filter/">Roots of Unity Filter Part 3 - Roots of Unity Filter</a><li><a href="/posts/amc-wrapped/">Four Years of AMC, Wrapped</a><li><a href="/posts/roots-of-unity/">Roots of Unity Filter Part 2 - Roots of Unity</a><li><a href="/posts/complex-numbers/">Roots of Unity Filter Part 1 - Complex Numbers</a></ul></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/complex-numbers/"><div class="card-body"> <span class="timeago small" > Apr 18 <i class="unloaded">2021-04-18T14:00:00-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Roots of Unity Filter Part 1 - Complex Numbers</h3><div class="text-muted small"><p> Note This is a three part series I wrote back in 2019 on a technique applicable to certain competitive math problems: roots of unity filters. The first two parts are just a recap of complex number...</p></div></div></a></div><div class="card"> <a href="/posts/roots-of-unity/"><div class="card-body"> <span class="timeago small" > Apr 18 <i class="unloaded">2021-04-18T15:00:00-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Roots of Unity Filter Part 2 - Roots of Unity</h3><div class="text-muted small"><p> Note This is a three part series I wrote back in 2019 on a technique applicable to certain competitive math problems: roots of unity filters. The first two parts are just a recap of complex number...</p></div></div></a></div><div class="card"> <a href="/posts/binary-exponentiation/"><div class="card-body"> <span class="timeago small" > Apr 19 <i class="unloaded">2021-04-19T11:00:00-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Binary Exponentiation</h3><div class="text-muted small"><p> Typical Exponentiation Letâ€™s say you wanted to calculate the large power of a number modulo another, such as \[7^{39} \pmod{1000}\] The most naive way to do this would be to literally multiply $...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/roots-of-unity/" class="btn btn-outline-primary" prompt="Older"><p>Roots of Unity Filter Part 2 - Roots of Unity</p></a> <a href="/posts/binary-exponentiation/" class="btn btn-outline-primary" prompt="Newer"><p>Binary Exponentiation</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="text-center text-muted small pb-5"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> const options = { scriptUrl: '//ryan10145-github-io.disqus.com/embed.js', disqusConfig: function() { this.page.title = 'Roots of Unity Filter Part 3 - Roots of Unity Filter'; this.page.url = 'https://ryan10145.github.io/posts/roots-of-unity-filter/'; this.page.identifier = '/posts/roots-of-unity-filter/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> Â© 2021 <a href="https://github.com/ryan10145">Ryan Chang</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/math/">math</a> <a class="post-tag" href="/tags/article/">article</a> <a class="post-tag" href="/tags/roots-of-unity-filter/">roots of unity filter</a> <a class="post-tag" href="/tags/roots-of-unity/">roots of unity</a> <a class="post-tag" href="/tags/exponents/">exponents</a> <a class="post-tag" href="/tags/modular-arithmetic/">modular arithmetic</a> <a class="post-tag" href="/tags/aime/">aime</a> <a class="post-tag" href="/tags/amc/">amc</a> <a class="post-tag" href="/tags/binary/">binary</a> <a class="post-tag" href="/tags/blog/">blog</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://ryan10145.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
